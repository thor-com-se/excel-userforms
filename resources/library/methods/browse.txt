    InjectCode ThisForm, "Function BrowseFileOrFolder(browseFor As String) As String"
    InjectCode ThisForm, "    Dim fd As FileDialog"
    InjectCode ThisForm, "    Dim chosenPath As String"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Check the parameter to decide if we are browsing for a file or folder"
    InjectCode ThisForm, "    If LCase(browseFor) = ""file"" Then"
    InjectCode ThisForm, "        Set fd = Application.FileDialog(msoFileDialogFilePicker)"
    InjectCode ThisForm, "    ElseIf LCase(browseFor) = ""folder"" Then"
    InjectCode ThisForm, "        Set fd = Application.FileDialog(msoFileDialogFolderPicker)"
    InjectCode ThisForm, "    Else"
    InjectCode ThisForm, "        BrowseFileOrFolder = ""Invalid parameter. Use 'file' or 'folder'."""
    InjectCode ThisForm, "        Exit Function"
    InjectCode ThisForm, "    End If"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Show the dialog"
    InjectCode ThisForm, "    With fd"
    InjectCode ThisForm, "        .AllowMultiSelect = False ' Allow only one selection"
    InjectCode ThisForm, "        If .Show = -1 Then ' If the user makes a selection"
    InjectCode ThisForm, "            chosenPath = .SelectedItems(1)"
    InjectCode ThisForm, "        Else ' If the user cancels"
    InjectCode ThisForm, "            chosenPath = """""
    InjectCode ThisForm, "        End If"
    InjectCode ThisForm, "    End With"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Return the chosen file or folder path"
    InjectCode ThisForm, "    BrowseFileOrFolder = chosenPath"
    InjectCode ThisForm, "End Function"