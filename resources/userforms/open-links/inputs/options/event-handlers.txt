    InjectCode ThisForm, "Private Sub ComboBoxColumn_Change()"
    InjectCode ThisForm, " Dim wb As Workbook"
    InjectCode ThisForm, " Dim ws As Worksheet"
    InjectCode ThisForm, " Dim lastRow As Long"
    InjectCode ThisForm, " Dim row As Long"
    InjectCode ThisForm, " Dim selectedColumn As String"
    InjectCode ThisForm, " Dim colNumber As Long"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " Me.ComboBoxFirstRow.Clear"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " On Error Resume Next"
    InjectCode ThisForm, " Set wb = Application.Workbooks(Me.ComboBoxFile.Value)"
    InjectCode ThisForm, " Set ws = wb.Worksheets(Me.ComboBoxSheet.Value)"
    InjectCode ThisForm, " selectedColumn = Me.ComboBoxColumn.Value"
    InjectCode ThisForm, " colNumber = ws.Range(selectedColumn & 1).Column"
    InjectCode ThisForm, " On Error GoTo 0"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " If Not ws Is Nothing And selectedColumn <> """" Then"
    InjectCode ThisForm, "     lastRow = ws.Cells(ws.Rows.Count, colNumber).End(xlUp).Row"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "     For row = 1 To lastRow"
    InjectCode ThisForm, "         Me.ComboBoxFirstRow.AddItem row"
    InjectCode ThisForm, "         If Me.ComboBoxFirstRow.ListCount = 1 Then"
    InjectCode ThisForm, "             Me.ComboBoxFirstRow.Value = row"
    InjectCode ThisForm, "         End If"
    InjectCode ThisForm, "     Next row"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "     Me.ComboBoxFirstRow.Enabled = True"
    InjectCode ThisForm, " End If"
    InjectCode ThisForm, "End Sub"

    InjectCode ThisForm, "Sub ComboBoxDomainFilter_Change()"
    InjectCode ThisForm, "    Dim selectedDomain As String"
    InjectCode ThisForm, "    Dim wb As Workbook"
    InjectCode ThisForm, "    Dim ws As Worksheet"
    InjectCode ThisForm, "    Dim selectedColumn As String"
    InjectCode ThisForm, "    Dim startRow As Long"
    InjectCode ThisForm, "    Dim lastRow As Long"
    InjectCode ThisForm, "    Dim currentRow As Long"
    InjectCode ThisForm, "    Dim cellValue As String"
    InjectCode ThisForm, "    Dim domain As String"
    InjectCode ThisForm, "    Dim validURL As Boolean"
    InjectCode ThisForm, "    Dim i As Long"
    InjectCode ThisForm, "    Dim alreadyExists As Boolean"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Clear the ListLinks list box"
    InjectCode ThisForm, "    Me.ListLinks.Clear"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    selectedDomain = Me.ComboBoxDomainFilter.Value"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Get the workbook and worksheet"
    InjectCode ThisForm, "    On Error Resume Next"
    InjectCode ThisForm, "    Set wb = Application.Workbooks(Me.ComboBoxFile.Value)"
    InjectCode ThisForm, "    Set ws = wb.Worksheets(Me.ComboBoxSheet.Value)"
    InjectCode ThisForm, "    selectedColumn = Me.ComboBoxColumn.Value"
    InjectCode ThisForm, "    startRow = CLng(Me.ComboBoxFirstRow.Value)"
    InjectCode ThisForm, "    On Error GoTo 0"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Ensure the worksheet and column are valid"
    InjectCode ThisForm, "    If Not ws Is Nothing And selectedColumn <> """" Then"
    InjectCode ThisForm, "        ' Find the last row in the selected column"
    InjectCode ThisForm, "        lastRow = ws.Cells(ws.Rows.Count, selectedColumn).End(xlUp).Row"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "        ' Loop through the rows and add matching URLs to ListLinks"
    InjectCode ThisForm, "        For currentRow = startRow To lastRow"
    InjectCode ThisForm, "            If Not IsEmpty(ws.Cells(currentRow, selectedColumn).Value) Then"
    InjectCode ThisForm, "                cellValue = ws.Cells(currentRow, selectedColumn).Value"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                ' Check if the URL is valid"
    InjectCode ThisForm, "                validURL = (Left(cellValue, 7) = ""http://"" Or Left(cellValue, 8) = ""https://"")"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                If validURL Then"
    InjectCode ThisForm, "                    ' Extract the domain from the URL"
    InjectCode ThisForm, "                    domain = Split(Split(cellValue, ""//"")(1), ""/"")(0)"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                    ' Remove the 'www.' prefix if it exists"
    InjectCode ThisForm, "                    If Left(domain, 4) = ""www."" Then"
    InjectCode ThisForm, "                        domain = Mid(domain, 5)"
    InjectCode ThisForm, "                    End If"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                    ' If ComboBoxDomainFilter is blank or the domain matches, check for uniqueness and add the URL to ListLinks"
    InjectCode ThisForm, "                    If selectedDomain = """" Or domain = selectedDomain Then"
    InjectCode ThisForm, "                        ' Check if cellValue already exists in ListLinks"
    InjectCode ThisForm, "                        alreadyExists = False"
    InjectCode ThisForm, "                        For i = 0 To Me.ListLinks.ListCount - 1"
    InjectCode ThisForm, "                            If Me.ListLinks.List(i) = cellValue Then"
    InjectCode ThisForm, "                                alreadyExists = True"
    InjectCode ThisForm, "                                Exit For"
    InjectCode ThisForm, "                            End If"
    InjectCode ThisForm, "                        Next i"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                        ' If not already exists, add the item"
    InjectCode ThisForm, "                        If Not alreadyExists Then"
    InjectCode ThisForm, "                            Me.ListLinks.AddItem cellValue"
    InjectCode ThisForm, "                        End If"
    InjectCode ThisForm, "                    End If"
    InjectCode ThisForm, "                End If"
    InjectCode ThisForm, "            End If"
    InjectCode ThisForm, "        Next currentRow"
    InjectCode ThisForm, "    End If"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Enable the OpenLinks button if there are items in the ListLinks list box"
    InjectCode ThisForm, "    Me.ButtonOpenLinks.Enabled = (Me.ListLinks.ListCount > 0)"
    InjectCode ThisForm, "End Sub"

    InjectCode ThisForm, "Private Sub ComboBoxFile_Change()"
    InjectCode ThisForm, "   Dim wb As Workbook"
    InjectCode ThisForm, "   Dim ws As Worksheet"
    InjectCode ThisForm, "   Dim lastSheetName As String"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "   Me.ComboBoxSheet.Clear"
    InjectCode ThisForm, "   On Error Resume Next"
    InjectCode ThisForm, "   Set wb = Application.Workbooks(Me.ComboBoxFile.Value)"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "   On Error GoTo 0"
    InjectCode ThisForm, "   If Not wb Is Nothing Then"
    InjectCode ThisForm, "       lastSheetName = """""
    InjectCode ThisForm, "       For Each ws In wb.Worksheets"
    InjectCode ThisForm, "           Me.ComboBoxSheet.AddItem ws.Name"
    InjectCode ThisForm, "            If Me.ComboBoxSheet.ListCount = 1 Then"
    InjectCode ThisForm, "                Me.ComboBoxSheet.Value = ws.Name ' Set default to the first sheet"
    InjectCode ThisForm, "            End If"
    InjectCode ThisForm, "       Next ws"
    InjectCode ThisForm, "       Me.ComboBoxSheet.Enabled = True"
    InjectCode ThisForm, "   End If"
    InjectCode ThisForm, "End Sub"

    InjectCode ThisForm, "Sub ComboBoxFirstRow_Change()"
    InjectCode ThisForm, "    Dim wb As Workbook"
    InjectCode ThisForm, "    Dim ws As Worksheet"
    InjectCode ThisForm, "    Dim selectedColumn As String"
    InjectCode ThisForm, "    Dim startRow As Long"
    InjectCode ThisForm, "    Dim lastRow As Long"
    InjectCode ThisForm, "    Dim currentRow As Long"
    InjectCode ThisForm, "    Dim cellValue As String"
    InjectCode ThisForm, "    Dim domain As String"
    InjectCode ThisForm, "    Dim itemExists As Boolean"
    InjectCode ThisForm, "    Dim validURL As Boolean"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Clear the ComboBoxDomainFilter combo box"
    InjectCode ThisForm, "    Me.ComboBoxDomainFilter.Clear"
    InjectCode ThisForm, "    Me.ComboBoxDomainFilter.AddItem """"" ' Add a blank option
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Get the workbook and worksheet"
    InjectCode ThisForm, "    On Error Resume Next"
    InjectCode ThisForm, "    Set wb = Application.Workbooks(Me.ComboBoxFile.Value)"
    InjectCode ThisForm, "    Set ws = wb.Worksheets(Me.ComboBoxSheet.Value)"
    InjectCode ThisForm, "    selectedColumn = Me.ComboBoxColumn.Value"
    InjectCode ThisForm, "    startRow = CLng(Me.ComboBoxFirstRow.Value)"
    InjectCode ThisForm, "    On Error GoTo 0"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "    ' Ensure the worksheet and column are valid"
    InjectCode ThisForm, "    If Not ws Is Nothing And selectedColumn <> """" Then"
    InjectCode ThisForm, "        ' Find the last row in the selected column"
    InjectCode ThisForm, "        lastRow = ws.Cells(ws.Rows.Count, selectedColumn).End(xlUp).Row"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "        ' Loop through the rows from startRow to lastRow and add valid URL domains to ComboBoxDomainFilter"
    InjectCode ThisForm, "        For currentRow = startRow To lastRow"
    InjectCode ThisForm, "            If Not IsEmpty(ws.Cells(currentRow, selectedColumn).Value) Then"
    InjectCode ThisForm, "                cellValue = ws.Cells(currentRow, selectedColumn).Value"
    InjectCode ThisForm, "                itemExists = False"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                ' Check if the URL is valid"
    InjectCode ThisForm, "                validURL = (Left(cellValue, 7) = ""http://"" Or Left(cellValue, 8) = ""https://"")"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                If validURL Then"
    InjectCode ThisForm, "                    ' Extract the domain from the URL"
    InjectCode ThisForm, "                    domain = Split(Split(cellValue, ""//"")(1), ""/"")(0)"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                    ' Remove the 'www.' prefix if it exists"
    InjectCode ThisForm, "                    If Left(domain, 4) = ""www."" Then"
    InjectCode ThisForm, "                        domain = Mid(domain, 5)"
    InjectCode ThisForm, "                    End If"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                    ' Check if the domain already exists in the ComboBoxDomainFilter"
    InjectCode ThisForm, "                    For i = 0 To Me.ComboBoxDomainFilter.ListCount - 1"
    InjectCode ThisForm, "                        If Me.ComboBoxDomainFilter.List(i) = domain Then"
    InjectCode ThisForm, "                            itemExists = True"
    InjectCode ThisForm, "                            Exit For"
    InjectCode ThisForm, "                        End If"
    InjectCode ThisForm, "                    Next i"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "                    ' Add the domain if it does not already exist"
    InjectCode ThisForm, "                    If Not itemExists Then"
    InjectCode ThisForm, "                        Me.ComboBoxDomainFilter.AddItem domain"
    InjectCode ThisForm, "                    End If"
    InjectCode ThisForm, "                End If"
    InjectCode ThisForm, "            End If"
    InjectCode ThisForm, "        Next currentRow"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "        Me.ComboBoxDomainFilter.Enabled = True"
    InjectCode ThisForm, "        ' Explicitly call ComboBoxDomainFilter_Change to populate ListLinks"
    InjectCode ThisForm, "        Call ComboBoxDomainFilter_Change"
    InjectCode ThisForm, "    End If"
    InjectCode ThisForm, "End Sub"

    InjectCode ThisForm, "Private Sub ComboBoxSheet_Change()"
    InjectCode ThisForm, " Dim wb As Workbook"
    InjectCode ThisForm, " Dim ws As Worksheet"
    InjectCode ThisForm, " Dim lastCol As Long"
    InjectCode ThisForm, " Dim col As Long"
    InjectCode ThisForm, " Dim hasValue As Boolean"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " Me.ComboBoxColumn.Clear"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " On Error Resume Next"
    InjectCode ThisForm, " Set wb = Application.Workbooks(Me.ComboBoxFile.Value)"
    InjectCode ThisForm, " Set ws = wb.Worksheets(Me.ComboBoxSheet.Value)"
    InjectCode ThisForm, " On Error GoTo 0"
    InjectCode ThisForm, ""
    InjectCode ThisForm, " If Not ws Is Nothing Then"
    InjectCode ThisForm, "     lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "     For col = 1 To lastCol"
    InjectCode ThisForm, "         hasValue = Application.WorksheetFunction.CountA(ws.Columns(col)) > 0"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "         If hasValue Then"
    InjectCode ThisForm, "             Me.ComboBoxColumn.AddItem Split(ws.Cells(1, col).Address, ""$"")(1)"
    InjectCode ThisForm, "             If Me.ComboBoxColumn.ListCount = 1 Then"
    InjectCode ThisForm, "              Me.ComboBoxColumn.Value = Split(ws.Cells(1, col).Address, ""$"")(1)"
    InjectCode ThisForm, "             End If"
    InjectCode ThisForm, "         End If"
    InjectCode ThisForm, "     Next col"
    InjectCode ThisForm, ""
    InjectCode ThisForm, "     Me.ComboBoxColumn.Enabled = True"
    InjectCode ThisForm, " End If"
    InjectCode ThisForm, "End Sub"